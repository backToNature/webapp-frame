var getCodeDependencies = function (code, baseDir, dir) {
    var fs = require('fs');
    var base = __dirname.replace(/\\/g, '/') + '/';
    var tmpl = fs.readFileSync(base + 'css-tmpl.js', 'utf8');


    // 保留格式
    /*
    var content = [];
    code = code.split(/\r|\n/);
    code.forEach(function (item) {
        if (item.trim() === '') {
            return;
        }
        item = '        ' + item.replace(/\'/g, '\\\'').replace(/\"/g, '\\\"');
        content.push(item);
    });
    */


    code = code.replace(/'/g, '"');
    var cleanCSS = new require('clean-css')();
    var content = cleanCSS.minify(code);
    content = encodeURIComponent(content);


    var arr = tmpl.split('[[CSS-TEXT]]');
    code = [
        arr[0],
        content,
        arr[1]
    ].join('');


    return {
        code: code,
        deps: []
    };
};


exports.getCodeDependencies = getCodeDependencies;